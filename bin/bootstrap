#!/bin/bash -e

bin/branding

if ! command -v ruby >/dev/null; then
  echo "Ruby is not installed. Cannot proceed."
  exit 1
fi

if ! command -v bundle >/dev/null; then
  echo "Bundler is not installed. Installing..."
  if [ -f Gemfile.lock ] && grep "BUNDLED WITH" Gemfile.lock >/dev/null; then
    gem install bundler -v "$(grep 'BUNDLED WITH' -A1 Gemfile.lock | tail -n 1)"
  fi
fi

if [ -f Gemfile ]; then
  bundle install
fi

if ! command -v node >/dev/null; then
  echo "Node is not installed. Cannot proceed."
  exit 1
fi

if ! command -v npm >/dev/null; then
  echo "npm command not found. Cannot proceed."
  exit 1
fi

if [ -f package.json ]; then
  npm install
fi
